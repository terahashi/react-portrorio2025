------------------------------------------------------------------
------------------------------------------------------------------
ğŸ”¶ã€ŒuseIntersection.jsã€ã¯ã€ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯åŒ–ã—ãŸInterSectionObserverã€‘








------------------------------------------------------------------
------------------------------------------------------------------
ğŸ”¶ä¸‹è¨˜ã¯ã€ŒåˆæœŸã«ä½¿ç”¨ã—ãŸ åŸºæœ¬ã®useEffectã‚’ä½¿ã£ãŸInterSectionObserverã€

â– â¬‡ï¸â¬‡ï¸â¬‡ï¸Home.jsx
import { useState, useRef, useEffect } from 'react';

import Header from '../components/Header';
import SampleContent from '../components/SampleContent';
import useIntersection from '../hooks/useIntersection';

import HeroscrambleText from '../components/HeroscrambleText';
import TypingText from '../components/TypingText';

const Home = () => {
  //////IntersectionObserverã‚’è¨­ç½®ã—ã¦ã€ŒHeaderã®æ–‡å­—è‰²ã‚’ç™½ã«å¤‰åŒ–ã•ã›ã‚‹ã€
  const [isDark, setIsDark] = useState(false);
  const heroRef = useRef(null); // ãƒ’ãƒ¼ãƒ­ãƒ¼ã‚¨ãƒªã‚¢ ã®Contentå†…ã®ç›£è¦–ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ
  const targetRef = useRef(null); // SampleContent ã®Contentå†…ã®ç›£è¦–ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ

  console.log(isDark);

  //IntersectionObserverã‚’ä½¿ç”¨
  //â¬‡ï¸â‘ ã€ŒSampleContentã€ã«å…¥ã£ãŸã‚‰Headerã‚’ç™½æ–‡å­—
  useEffect(() => {
    const observer = new IntersectionObserver(
      ([entry]) => {
        if (entry.isIntersecting) {
          setIsDark(true); //ç™½
        }
      },
      { threshold: 0.93 } //ã€ŒSampleContentã€ãŒ93%äº¤å·®ã—ãŸã‚‰ç™½ã«ã™ã‚‹
      // { threshold: æ•°å€¤ }ã®ã€Œæ•°å€¤ã¯0.01~0.99ã€ãŒå¤šãä½¿ç”¨ã•ã‚Œã‚‹
    );
    if (targetRef.current) observer.observe(targetRef.current);
    return () => observer.disconnect(); //ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—
  }, []);

  //â¬‡ï¸â‘¡ä¸Šã«æˆ»ã‚Šãƒ’ãƒ¼ãƒ­ãƒ¼ã‚¨ãƒªã‚¢ã«å…¥ã£ãŸã‚‰Headerã‚’é»’æ–‡å­—
  useEffect(() => {
    const observer = new IntersectionObserver(
      ([entry]) => {
        if (entry.isIntersecting) {
          setIsDark(false); //é»’
        }
      },
      { threshold: 0.05 } //ã€Œãƒ’ãƒ¼ãƒ­ãƒ¼ã‚¨ãƒªã‚¢ã€ãŒ5%äº¤å·®ã—ãŸã‚‰é»’ã«æˆ»ã™
    );
    if (heroRef.current) observer.observe(heroRef.current);
    return () => observer.disconnect(); //ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—
  }, []);


  return (
    <>
        <Header dark={isDark} />

        <div ref={targetRef} className='bg-[#deba99] w-full h-screen mt-20'>
          <HeroscrambleText />
          <TypingText />
          <h1 className='bg-[#da5555]'>Home ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸ã§ã™ã€‚</h1>
           <div className='bg-custom-yellow'>
             <h1>å­è¦ç´ (èƒŒæ™¯é»„è‰²ã¯bg-custom-yellowã®ã€ŒTailwindcssã®ã‚«ã‚¹ã‚¿ãƒ ã€)</h1>
           </div>
        </div>

        <SampleContent targetRef={targetRef} />

        <div className='bg-black w-full h-screen'>
          <h2>content2</h2>
        </div>

        <SampleContent />
    </>
  );
};

export default Home;




â– â¬‡ï¸â¬‡ï¸â¬‡ï¸Header.jsx
const HeaderWrap = styled.header`
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  padding: 20px;
  font-size: 1.8rem;
  font-weight: bold;
  z-index: 999;
  background-color: #808080;
  /* â¬‡ï¸$darkãŒã€Œtrueãªã‚‰ç™½ã€ã€Œfalseãªã‚‰é»’ã€ */
  /* useStateã®åˆæœŸå€¤ã¯falseã€‚$dark = falseãªã®ã§ã€Œæœ€åˆã¯'black'ãŒé¸æŠã•ã‚Œã‚‹ã€ */
  color: ${(props) => (props.$dark ? 'white' : 'black')};
  `;

//â¬‡ï¸Home.jsxã®<Header/>ã§å—ã‘å–ã£ãŸã€darkã‚’styled-componentsã«$darkã¨ã„ã†åå‰ã§æ¸¡ã—ã¦ã„ã‚‹ã€‘
  const Header = ({ dark }) => {
    return <HeaderWrap $dark={dark}>sample</HeaderWrap>;
  };

export default Header;



â– â¬‡ï¸â¬‡ï¸â¬‡ï¸SampleContent.jsx
// SampleContent.jsx
const SampleContent = ({ targetRef }) => {
  return (
    <div>
      <section ref={targetRef} style={{ height: '100vh', background: '#ccc' }}>
        WATCH AREAï¼ˆã“ã“ã«æ¥ãŸã‚‰ Header ã®è‰²ãŒå¤‰ã‚ã‚‹ï¼‰
      </section>
    </div>
  );
};

export default SampleContent;


------------------------------------------------------------------
------------------------------------------------------------------

